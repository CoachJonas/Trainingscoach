<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>TrainingCoach v13.10.1 AutoDetect Pro</title>
<style>
  body {
    font-family: Arial, sans-serif;
    background: #0d0d0d;
    color: #fff;
    margin: 0;
    padding: 0;
  }
  header {
    background: #1c1c1c;
    padding: 10px;
    text-align: center;
    font-size: 20px;
    font-weight: bold;
  }
  section {
    padding: 15px;
  }
  select, input, button, textarea {
    width: 100%;
    margin: 5px 0;
    padding: 8px;
    border-radius: 8px;
    border: none;
    font-size: 16px;
  }
  button {
    background: #007bff;
    color: #fff;
    font-weight: bold;
  }
  .exercise {
    background: #1a1a1a;
    margin-top: 10px;
    padding: 10px;
    border-radius: 8px;
  }
  .note {
    background: #222;
    color: #ccc;
    font-size: 14px;
    padding: 4px;
    border-radius: 6px;
  }
</style>
</head>
<body>
<header>TrainingCoach v13.10.1 AutoDetect Pro</header>

<section>
  <h3 id="status">Loading data...</h3>

  <button id="loadBackupBtn">ðŸ“‚ Load Backup (CSV/Text)</button>
  <button id="saveBackupBtn">ðŸ’¾ Export CSV</button>

  <div>
    <label>Session:</label>
    <select id="sessionSelect">
      <option value="night_upper">Night Upper</option>
      <option value="night_lower">Night Lower</option>
      <option value="free_push">Free Push</option>
      <option value="free_pull">Free Pull</option>
      <option value="free_legs">Free Legs</option>
    </select>
  </div>

  <div id="exerciseContainer"></div>
</section>

<script>
let trainingData = JSON.parse(localStorage.getItem("trainingData") || "[]");

function renderExercises(sessionId) {
  const container = document.getElementById("exerciseContainer");
  container.innerHTML = "";

  const sessionExercises = trainingData.filter(x => x.sessionId === sessionId);
  if (sessionExercises.length === 0) {
    container.innerHTML = "<p>No data for this session.</p>";
    return;
  }

  sessionExercises.forEach((ex, i) => {
    const div = document.createElement("div");
    div.className = "exercise";
    div.innerHTML = `
      <h4>${ex.exerciseId}</h4>
      <p>Last: ${ex.weight} kg Ã— ${ex.reps}</p>
      <p class="note">${ex.note || ""}</p>
      <p><b>Coach:</b> ${getNextWeightSuggestion(ex)}</p>
    `;
    container.appendChild(div);
  });
}

function getNextWeightSuggestion(ex) {
  const reps = ex.reps.split("-").map(x => parseInt(x));
  const avg = reps.reduce((a,b)=>a+b,0) / reps.length;
  if (avg >= 10) return "â†‘ +2.5 kg next time";
  if (avg <= 6) return "â†“ âˆ’1 kg next time";
  return "= keep weight";
}
